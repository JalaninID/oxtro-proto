syntax = "proto3";

package auth.v1;

message LoginRequest {
      string username = 1;
      string password = 2;
      string device_id = 3;
}

message LoginResponse {
      string access_token = 1;
      string refresh_token = 2;
      int64 access_token_expires_at = 3;
      int64 refresh_token_expires_at = 4;
}

message RegisterRequest{
      string username = 1;
      string password = 2;
      string email = 3;
      string name = 4;
      string profile = 5;
      bool premium = 6;
}

message RegisterResponse{
      string id = 1;
      string created_at = 2;
      string updated_at = 3;
      string username = 4;
      string email = 9;
      string name = 5;
      string profile = 6;
      string status = 7;
      bool premium = 8;
}

message RefreshTokenRequest {
      string refresh_token = 1;
      string device_id = 2;
}

message RefreshTokenResponse {
      string access_token = 1;
      string refresh_token = 2;
      int64 access_token_expires_at = 3;
      int64 refresh_token_expires_at = 4;
}

message LogoutRequest {
      string refresh_token = 1;
}

message LogoutAllRequest {
}

message ForgotPasswordRequest {
      string email = 1;
}

message ForgotPasswordResponse {
      bool accepted = 1;
}

message ResetPasswordRequest {
      string token = 1;
      string new_password = 2;
}

message ChangePasswordRequest {
      string old_password = 1;
      string new_password = 2;
}

message VerifyEmailRequest {
      string token = 1;
}

message ResendEmailVerificationRequest {
      string email = 1;
}

message Session {
      string id = 1;
      string device_id = 2;
      string user_agent = 3;
      string ip = 4;
      string created_at = 5;
      string expires_at = 6;
      bool revoked = 7;
}

message ListSessionsRequest {
}

message ListSessionsResponse {
      repeated Session sessions = 1;
}

message RevokeSessionRequest {
      string session_id = 1;
}

message AuthStatusResponse {
      bool success = 1;
      string message = 2;
}

service Auth {
      rpc Register(RegisterRequest) returns (RegisterResponse);
      rpc Login(LoginRequest) returns (LoginResponse);
      rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);
      rpc Logout(LogoutRequest) returns (AuthStatusResponse);
      rpc LogoutAll(LogoutAllRequest) returns (AuthStatusResponse);
      rpc ForgotPassword(ForgotPasswordRequest) returns (ForgotPasswordResponse);
      rpc ResetPassword(ResetPasswordRequest) returns (AuthStatusResponse);
      rpc ChangePassword(ChangePasswordRequest) returns (AuthStatusResponse);
      rpc VerifyEmail(VerifyEmailRequest) returns (AuthStatusResponse);
      rpc ResendEmailVerification(ResendEmailVerificationRequest) returns (AuthStatusResponse);
      rpc ListSessions(ListSessionsRequest) returns (ListSessionsResponse);
      rpc RevokeSession(RevokeSessionRequest) returns (AuthStatusResponse);
}
